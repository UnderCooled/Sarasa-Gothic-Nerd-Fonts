{
  "version": "0.33.1",
  "description": "Nerd Fonts patched Sarasa Mono TC",
  "homepage": "https://github.com/jonz94/Sarasa-Mono-TC-Nerd-Font",
  "license": "OFL-1.1",
  "url": "https://github.com/jonz94/Sarasa-Mono-TC-Nerd-Font/releases/download/v0.33.1/sarasa-mono-tc-nerd-font.zip",
  "hash": "3f4fa0abaae975dd1aa3a8660be6b4ca61efeb7fc838fb7f56fc4e2dddc1efc2",
  "installer": {
    "script": [
      "$fontList = \"${dir}\\list.txt\"",
      "$fontDir = if ($global) { \"${env:windir}\\Fonts\" } else { \"${HOME}\\AppData\\Local\\Microsoft\\Windows\\Fonts\" }",
      "$root = if ($global) { \"HKLM\" } else { \"HKCU\" }",
      "if (-Not $global) {",
      "  New-Item $fontDir -ItemType Directory -ErrorAction SilentlyContinue | Out-Null",
      "}",
      "New-Item $fontList | Out-Null",
      "Get-ChildItem $dir -Filter '*.ttf' | ForEach-Object {",
      "  Add-Content $fontList -Encoding utf8 -Value $_.Name",
      "  Move-Item $_.FullName -Destination $fontDir",
      "  Get-ChildItem $fontDir -Filter $_.Name | ForEach-Object {",
      "    $value = if ($global) { $_.Name } else { $_.FullName }",
      "    New-ItemProperty -Path \"${root}:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\" -Name $_.Name.Replace($_.Extension, ' (TrueType)') -Value $value -Force | Out-Null",
      "  }",
      "}"
    ]
  },
  "uninstaller": {
    "script": [
      "$fontList = \"${dir}\\list.txt\"",
      "$fontDir = if ($global) { \"${env:windir}\\Fonts\" } else { \"${HOME}\\AppData\\Local\\Microsoft\\Windows\\Fonts\" }",
      "$root = if ($global) { \"HKLM\" } else { \"HKCU\" }",
      "Get-Content $fontList | ForEach-Object {",
      "  Get-ChildItem $fontDir -Filter $_ | ForEach-Object {",
      "    try {",
      "      Rename-Item $_.FullName $_.FullName -ErrorVariable LockError -ErrorAction Stop",
      "    } catch {",
      "      error \"$app is being used by another process.\"",
      "      error \"Please close all applications (e.g. vscode) that are using $app before upgrade/uninstall.\"",
      "      exit 1",
      "    }",
      "  }",
      "}",
      "Get-Content $fontList | ForEach-Object {",
      "  Get-ChildItem $fontDir -Filter $_ | ForEach-Object {",
      "    Remove-ItemProperty -Path \"${root}:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\" -Name $_.Name.Replace($_.Extension, ' (TrueType)') -Force -ErrorAction SilentlyContinue",
      "    Remove-Item \"${fontDir}\\$($_.Name)\" -Force -ErrorAction SilentlyContinue",
      "  }",
      "}",
      "Write-Host \"The 'Sarasa Mono TC Nerd Font' has been uninstalled and will not be present after restarting your computer.\" -Foreground Magenta"
    ]
  }
}
